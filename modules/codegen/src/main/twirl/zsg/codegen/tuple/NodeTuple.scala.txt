@(tagNum: Int)(maxAsunaTupleNum: Int, maxAsunaContext: Int)(isDotty: Boolean)

package zsg

final class NodeTuple@{tagNum}[@{asuna.codegen.SnippetUtil.XI_TupleTag_Snippet(1 to tagNum).mkString(" , ")}](@{asuna.codegen.SnippetUtil.II_Snippet(1 to tagNum).mkString(" , ")}) extends TupleTag

object NodeTuple@{tagNum} {

    @if(tagNum == 1) {
        @for(typeParamNum <- 1 to maxAsunaContext) {
            @if(isDotty) { given } else { implicit def } tupleTagApplicationImplicit_tagNum1_typeParamNum@{typeParamNum}[F[_ @for(i <- 2 to typeParamNum) { , _ }] @for(ii <- 1 to typeParamNum) { , X1_C@{ii} <: TupleTag }](@if(isDotty) { using } else { implicit } t1: Application@{typeParamNum}[F @for(i <- 1 to typeParamNum) { , X1_C@{i} }]
            ) @if(isDotty) { as } else { : } Application@{typeParamNum}[F @for(i <- 1 to typeParamNum) { , NodeTuple1[X1_C@{i}] }] = {
                new Application@{typeParamNum}[F @for(i <- 1 to typeParamNum) { , NodeTuple1[X1_C@{i}] }] {
                    override def application(context: Context@{typeParamNum}[F]): F[NodeTuple1[X1_C1]
                    @for(i <- 2 to typeParamNum) { , NodeTuple1[X1_C@{i}] }] = {
                        context.append(context.start, t1.application(context))(NodeTuple1.cachePlus@{typeParamNum}WithTypeParameter0)
                    }
                }
            }
        }
    } else {
        @for(typeParamNum <- 1 to maxAsunaContext) {
            @if(isDotty) { given } else { implicit def } tupleTagApplicationImplicit_tagNum2_typeParamNum@{typeParamNum}[F[_ @for(i <- 2 to typeParamNum) { , _ }] @for(ii <- 1 to typeParamNum) { , X1_C@{ii} <: TupleTag } @for(ii <- 1 to typeParamNum) { , X2_C@{ii} <: TupleTag }](@if(isDotty) { using } else { implicit } t1: Application@{typeParamNum}[F @for(i <- 1 to typeParamNum) { , X1_C@{i} }], t2: Application@{typeParamNum}[F @for(i <- 1 to typeParamNum) { , X2_C@{i} }]
            ) @if(isDotty) { as } else { : } Application@{typeParamNum}[F @for(i <- 1 to typeParamNum) { , NodeTuple2[X1_C@{i}, X2_C@{i}] }] = {
                new Application@{typeParamNum}[F @for(i <- 1 to typeParamNum) { , NodeTuple2[X1_C@{i}, X2_C@{i}] }] {
                    override def application(context: Context@{typeParamNum}[F]): F[NodeTuple2[X1_C1, X2_C1]
                    @for(i <- 2 to typeParamNum) { , NodeTuple2[X1_C@{i}, X2_C@{i}] }] = {
                        context.append(t2.application(context), t1.application(context))(NodeTuple2.cachePlus@{typeParamNum}WithTypeParameter1)
                    }
                }
            }
        }
    }

    @for(eachContextNum <- 1 to maxAsunaContext) {
        @if(tagNum == 1) {
            @@inline final def cachePlus@{eachContextNum}WithTypeParameter0Dynamic[@{asuna.codegen.SnippetUtil.YI_TupleTag_Snippet(1 to eachContextNum).mkString(" , ")}]: Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.AsunaTuple0_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.YI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.NodeTuple1_YI_Snippet(1 to eachContextNum).mkString(" , ")}
            ] = new Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.AsunaTuple0_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.YI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.NodeTuple1_YI_Snippet(1 to eachContextNum).mkString(" , ")}
            ] {
                @for(i <- 1 to eachContextNum) {
                    final override def takeHead@{i}(z: NodeTuple1[Y@{i}]): ZsgTuple0 = ZsgTuple0.value
                    final override def takeTail@{i}(z: NodeTuple1[Y@{i}]): Y@{i} = z.i1
                    final override def plus@{i}(x: ZsgTuple0, y: Y@{i}): NodeTuple1[Y@{i}] = new NodeTuple1(y)
                }
            }

            final val cachePlus@{eachContextNum}WithTypeParameter0Strict: Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.AsunaTuple0_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.TupleTag_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.NodeTuple1_TupleTag_Any_Snippet(1 to eachContextNum).mkString(" , ")}
            ] = cachePlus@{eachContextNum}WithTypeParameter0Dynamic[@{asuna.codegen.SnippetUtil.TupleTag_Snippet(1 to eachContextNum).mkString(" , ")}]

            @@inline final def cachePlus@{eachContextNum}WithTypeParameter0[@{asuna.codegen.SnippetUtil.YI_TupleTag_Snippet(1 to eachContextNum).mkString(" , ")}]: Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.AsunaTuple0_Snippet(1 to eachContextNum).mkString("", " , ", ",")}
                @{asuna.codegen.SnippetUtil.YI_Snippet(1 to eachContextNum).mkString("", " , ", ",")}
                @{asuna.codegen.SnippetUtil.NodeTuple1_YI_Snippet(1 to eachContextNum).mkString(" , ")}
            ] = cachePlus@{eachContextNum}WithTypeParameter0Strict.asInstanceOf[Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.AsunaTuple0_Snippet(1 to eachContextNum).mkString("", " , ", ",")}
                @{asuna.codegen.SnippetUtil.YI_Snippet(1 to eachContextNum).mkString("", " , ", ",")}
                @{asuna.codegen.SnippetUtil.NodeTuple1_YI_Snippet(1 to eachContextNum).mkString(" , ")}
            ]]
        } else {
            @@inline final def cachePlus@{eachContextNum}WithTypeParameter1Dynamic[
                @{asuna.codegen.SnippetUtil.XI_TupleTag_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.YI_TupleTag_Snippet(1 to eachContextNum).mkString(" , ")}
            ]: Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.XI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.YI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.NodeTuple2_XI_YI_Snippet(1 to eachContextNum).mkString(" , ")}
            ] = new Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.XI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.YI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.NodeTuple2_XI_YI_Snippet(1 to eachContextNum).mkString(" , ")}
            ] {
                @for(i <- 1 to eachContextNum) {
                    final override def takeHead@{i}(z: NodeTuple2[Y@{i}, X@{i}]): X@{i} = z.i2
                    final override def takeTail@{i}(z: NodeTuple2[Y@{i}, X@{i}]): Y@{i} = z.i1
                    final override def plus@{i}(x: X@{i}, y: Y@{i}): NodeTuple2[Y@{i}, X@{i}] = new NodeTuple2(y, x)
                }
            }

            final val cachePlus@{eachContextNum}WithTypeParameter1Strict: Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.TupleTag_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.TupleTag_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.NodeTuple2_TupleTag_Any_Any_Snippet(1 to eachContextNum).mkString(" , ")}
            ] = cachePlus@{eachContextNum}WithTypeParameter1Dynamic[
                @{asuna.codegen.SnippetUtil.TupleTag_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.TupleTag_Snippet(1 to eachContextNum).mkString(" , ")}
            ]

            @@inline final def cachePlus@{eachContextNum}WithTypeParameter1[
                @{asuna.codegen.SnippetUtil.XI_TupleTag_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.YI_TupleTag_Snippet(1 to eachContextNum).mkString(" , ")}
            ]: Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.XI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.YI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.NodeTuple2_XI_YI_Snippet(1 to eachContextNum).mkString(" , ")}
            ] = cachePlus@{eachContextNum}WithTypeParameter1Strict.asInstanceOf[Plus@{eachContextNum}[
                @{asuna.codegen.SnippetUtil.XI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.YI_Snippet(1 to eachContextNum).mkString(" , ")},
                @{asuna.codegen.SnippetUtil.NodeTuple2_XI_YI_Snippet(1 to eachContextNum).mkString(" , ")}
            ]]
        }
    }

}