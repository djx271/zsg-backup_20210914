@(tagNum: Int)

package asuna

import asuna.support.heterogeneous._

class AsunaTuple@{tagNum}[@for(ii <- 1 to tagNum) { E@{ii} @if(ii < tagNum) { , } }]
(override val head: E1
@if(tagNum > 1) { , override val tail: AsunaTuple@{tagNum - 1}[@for(ii <- 2 to tagNum) { E@{ii} @if(ii < tagNum) { , } }] }
)
extends HList {
    override type Head = E1
    @if(tagNum > 1) {
        override type Tail = AsunaTuple@{tagNum - 1}[@for(ii <- 2 to tagNum) { E@{ii} @if(ii < tagNum) { , } }]
    } else {
        override type Tail = AsunaTuple0
        override def tail: AsunaTuple0 = AsunaTuple0.value
    }

    def i1: E1 = head
    @for(ii <- 2 to tagNum) {
        def i@{ii}: E@{ii} = tail@for(_ <- 3 to ii) { .tail }.head
    }

    override type Append[T] = @if(tagNum < 8) {
        AsunaTuple@{tagNum + 1}[T @for(ii <- 1 to tagNum) { , E@{ii} }]
    } else {
        T :: AsunaTuple@{tagNum}[@for(ii <- 1 to tagNum) { E@{ii} @if(ii < tagNum) { , } }]
    }
    override def ::[T](t: T): Append[T] = @if(tagNum < 8) {
        new AsunaTuple@{tagNum + 1}[T @for(ii <- 1 to tagNum) { , E@{ii} }](t, this)
    } else {
        t :: this
    }

}